<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <!--스타일-->
        <link rel="stylesheet" href="./css/style.css">
        <!--스크립트-->
        <script type="text/javascript" src="./script/script.js"></script>
        <script type="text/javascript" src="./script/app.js"></script> 
        <!--폰트-->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
        <script src="https://unpkg.com/youtube-background@1.0.14/jquery.youtube-background.min.js"></script>
        <!-- (1) xlsx 라이브러리 추가) -->
        <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
        <link rel="manifest" href="manifest.json" />
        <!-- <link rel="manifest" href="manifest.webmanifest" /> -->
        <meta name="theme-color" content="#000000" />
    </head>
    <body>
        <div class="Wrap">
            <header>
                이스케이프 컴퍼니
            </header>
            <main>
                <div class="totalHint">힌트 사용 <span class="count">0개</span></div>
                <div class="searchBox">
                    <input type="text" class="ipt" placeholder="힌트코드를 입력해주세요."/>
                    <button type="button" class="searchBtn"><img src="./img/search.png" alt="돋보기" class="icon"/></button>
                </div>
                <div class="contentDiv"></div>
                <div class="resultDiv"></div>
                <div class="btnDiv">
                    <button type="button" class="item backBtn">뒤로가기</button>
                    <button type="button" class="item showResult">정답보기</button>
                </div>


                <div class="adminWrap">
                    <input type="file" class="ipt"/>
                    <input type="text" class="ipt" placeholder="관리자 비밀번호"/>
                    <button class="uploadBtn">업로드</button>
                </div>
            </main>
            <footer>
                © 이스케이프월드 탱지 . All rights reserved. <br/>
                <button type="button" class="adminBtn"><img src="./img/admin.png" class="icon"></button>
            </footer>
        </div>


        <script>
            const CACHE_NAME = 'hintapp-cache-v1';
            const urlsToCache = [
            './',
            './index.html',
            './css/style.css',
            './script/script.js',
            './script/app.js',
            './img/search.png',
            './manifest.json'
            ];

            // 설치 이벤트 (처음 설치할 때 파일들 캐싱)
            self.addEventListener('install', (event) => {
            console.log('[Service Worker] 설치 완료!');
            event.waitUntil(
                caches.open(CACHE_NAME)
                .then((cache) => {
                    console.log('[Service Worker] 파일 캐싱 완료!');
                    return cache.addAll(urlsToCache);
                })
            );
            self.skipWaiting();
            });

            // 활성화 이벤트 (구버전 캐시 삭제용, 지금은 심플)
            self.addEventListener('activate', (event) => {
            console.log('[Service Worker] 활성화 완료!');
            event.waitUntil(
                caches.keys().then(cacheNames => {
                return Promise.all(
                    cacheNames.map(name => {
                    if (name !== CACHE_NAME) {
                        console.log('[Service Worker] 구 캐시 삭제:', name);
                        return caches.delete(name);
                    }
                    })
                );
                })
            );
            self.clients.claim();
            });

            // fetch 이벤트 (캐시 먼저 확인하고 없으면 네트워크 요청)
            self.addEventListener('fetch', (event) => {
            event.respondWith(
                caches.match(event.request)
                .then((response) => {
                    return response || fetch(event.request);
                })
            );
            });
        </script>
    </body>
</html>